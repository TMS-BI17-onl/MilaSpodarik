1. 
SELECT m.FIRST_NAME, m.LAST_NAME, COUNT(1) AS TOTAL_EMPLOYEES
FROM EMPLOYEES e JOIN EMPLOYEES m ON e.MANAGER_ID = m.EMPLOYEE_ID
GROUP BY m.FIRST_NAME, m.LAST_NAME
HAVING COUNT(1) > 6;

2.
SELECT DEPARTMENT_NAME, min_SALARY, max_SALARY
FROM 
(
SELECT DEPARTMENT_NAME, MIN (SALARY-SALARY *(COMMISSION_PCT/100)) as min_SALARY
			MAX (SALARY-SALARY *(COMMISSION_PCT/100)) as max_SALARY
FROM DEPARTMENTS d JOIN EMPLOYEES e
	ON d.DEPARTMENTS_ID=e.DEPARTMENTS_ID
) T
GROUP BY DEPARTMENT_NAME;

3.
SELECT TOP 1 WITH TIES r.REGION_NAME, COUNT(EMPLOYEE_ID) AS TOTAL_EMPLOYEES
FROM REGIONS r
JOIN COUNTRIES c ON r.REGION_ID = c.REGION_ID
JOIN LOCATIONS l ON c.COUNTRY_ID = l.COUNTRY_ID
JOIN DEPARTMENTS d ON l.LOCATION_ID = d.LOCATION_ID
JOIN EMPLOYEES e ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
GROUP BY r.REGION_NAME
ORDER BY TOTAL_EMPLOYEES DESC;

4. - can't resolve 

5. 
SELECT 
    e.FIRST_NAME, 
    e.LAST_NAME, 
    j.START_DATE, 
    j.END_DATE, 
    DATEDIFF(YEAR, j.START_DATE, j.END_DATE) AS YEARS_WORKED 
FROM EMPLOYEES e INNER JOIN JOB_HISTORY j
			ON e.EMPLOYEE_ID = j.EMPLOYEE_ID 
WHERE DATEDIFF(YEAR, j.START_DATE, j.END_DATE) > 10;

6.
SELECT *
FROM 
(
  SELECT FIRST_NAME, LAST_NAME, SALARY, DENSE_RANK() OVER (ORDER BY SALARY DESC) AS salary_rank
  FROM EMPLOYEES
) AS ranked_employees
WHERE salary_rank BETWEEN 5 AND 10;













